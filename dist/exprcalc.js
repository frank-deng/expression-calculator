!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Calc=t():e.Calc=t()}(self,(function(){return function(){"use strict";var e={d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t={};e.d(t,{default:function(){return C}});var r={"+":{binocular:!0,priority:14,exchangeable:!0,processor:function(e,t){return e+t}},"-":{binocular:!0,priority:14,exchangeable:!1,processor:function(e,t){return e-t}},"*":{binocular:!0,priority:15,exchangeable:!0,processor:function(e,t){return e*t}},"/":{binocular:!0,priority:15,exchangeable:!1,processor:function(e,t){return e/t}},"%":{binocular:!0,priority:15,exchangeable:!1,processor:function(e,t){return e%t}},"**":{binocular:!0,priority:16,exchangeable:!1,rightToLeft:!0,processor:function(e,t){return Math.pow(e,t)}},"&":{binocular:!0,priority:10,exchangeable:!0,bitwise:!0,processor:function(e,t){return e&t}},"|":{binocular:!0,priority:8,exchangeable:!0,bitwise:!0,processor:function(e,t){return e|t}},"^":{binocular:!0,priority:9,exchangeable:!0,bitwise:!0,processor:function(e,t){return e^t}},"~":{binocular:!1,priority:17,bitwise:!0,processor:function(e){return~e}},NEG:{match:!1,binocular:!1,priority:17,processor:function(e){return-e}}},n=["(",")"];for(var o in r)!1!==r[o].match&&n.push(o);n.sort((function(e,t){return t.length-e.length}));var i,a=n.map((function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})),u=new RegExp("^("+a.join("|")+")"),c=r;function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i=Symbol.iterator;var s,p,y,h,b=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.__input=this.__inputOrig=t,this.__pos=0}var t,r;return t=e,(r=[{key:i,value:function(){return this}},{key:"__proc",value:function(t){var r,n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(e.__lexTable);try{for(n.s();!(r=n.n()).done;){var o=r.value,i=o.rule.exec(t);if(i&&0==i.index)return{type:o.type,value:i[0]}}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"getPos",value:function(){return this.__pos}},{key:"next",value:function(){for(;this.__input;){var e=this.__proc(this.__input);if(!e)throw new SyntaxError("Unexpected Character at position ".concat(this.__pos));var t=e.type,r=e.value;if(this.__input=this.__input.slice(r.length),this.__pos+=r.length,t)return{done:!1,value:{type:t,value:r}}}return this.__input=this.__inputOrig,this.__pos=0,{done:!0}}}])&&f(t.prototype,r),e}();function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t,r){return(w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=O(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}y=[{rule:/^\s+/,type:null},{rule:/^0x[0-9A-Fa-f]+/,type:1},{rule:/^[0-9]+(\.[0-9]+)?([Ee][+\-][0-9]+)?/,type:1},{rule:u,type:3},{rule:/^[A-Za-z_\u0080-\uffff][A-Za-z0-9_\u0080-\uffff]*/,type:2}],(p="__lexTable")in(s=b)?Object.defineProperty(s,p,{value:y,enumerable:!0,configurable:!0,writable:!0}):s[p]=y,h=Symbol.iterator;var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(u,e);var t,r,n,o,i,a=(o=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=O(o);if(i){var r=O(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return m(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=a.call(this,e)).__reset(),t}return t=u,n=[{key:"getTokenType",value:function(e){return e?1==e.type||2==e.type?"N":3==e.type?"("==e.value?"(":")"==e.value?")":c[e.value].binocular?"B":"S":null:"START"}}],(r=[{key:h,value:function(){return this}},{key:"__reset",value:function(){Object.assign(this,{__lastToken:null,__lastTokenType:"START",__bracketDepth:0})}},{key:"next",value:function(){var e=u.syntaxTable;try{var t=w(O(u.prototype),"next",this).call(this),r=t.done,n=t.value,o=w(O(u.prototype),"getPos",this).call(this),i=null,a=null;if(r)a="END";else{if(o-=n.value.length,3==(i=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){j(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},n)).type&&"-"==i.value&&u.lastTokenNEGConv[this.__lastTokenType]){var c=this.__lastToken;if(c&&3==c.type&&("NEG"==c.value||"-"==c.value))throw new SyntaxError("Invalid input at position ".concat(o));i.value="NEG"}a=u.getTokenType(i)}if(!e[this.__lastTokenType]||!e[this.__lastTokenType][a])throw new SyntaxError("Invalid input at position ".concat(o));switch(a){case"(":this.__bracketDepth++;break;case")":this.__bracketDepth--;break;case"END":if(this.__bracketDepth)throw new SyntaxError("Bracket mismatch")}return"END"==a?(this.__reset(),{done:!0}):(this.__lastToken=i,this.__lastTokenType=a,{done:!1,value:i})}catch(e){try{this.__reset()}catch(e){console.error(e)}throw e}}}])&&g(t.prototype,r),n&&g(t,n),u}(b);function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function x(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}j(P,"syntaxTable",{START:{N:!0,S:!0,"(":!0},N:{B:!0,")":!0,END:!0},S:{N:!0,"(":!0},B:{N:!0,"(":!0,S:!0},"(":{S:!0,N:!0,"(":!0},")":{")":!0,B:!0,END:!0}}),j(P,"lastTokenNEGConv",{START:!0,"(":!0,B:!0,S:!0});var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=D(t);if(r){var o=D(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return A(this,e)});function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),n.call(this,e)}return o}(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),x(this,"__data",[]),t instanceof e&&this.setRPN(t.getRPN()),"string"==typeof t?this.compile(t):Array.isArray(t)&&t.length&&this.setRPN(t)}var t,r;return t=e,(r=[{key:"__numConv",value:function(e){if(isNaN(e))throw new TypeError("Invalid number format");return Number(e)}},{key:"compile",value:function(e){var t,r=[],n=[],o=S(new P(e));try{for(o.s();!(t=o.n()).done;){var i=t.value;if(1==i.type)i.value=this.__numConv(i.value),r.push(i);else if(2==i.type)r.push(i);else if(3==i.type)if(n.length&&"("!=i.value)if(")"==i.value)for(var a=null;(a=n.pop())&&"("!=a.value;)r.push(a);else{for(;n.length;){var u=n[n.length-1].value,l=c[u],f=c[i.value];if("("==u||l.priority<f.priority||l.rightToLeft&&f.rightToLeft)break;r.push(n.pop())}n.push(i)}else n.push(i)}}catch(e){o.e(e)}finally{o.f()}for(;n.length;)r.push(n.pop());return this.__data=r,this}},{key:"compress",value:function(){var e,t=[],r=S(this.__data);try{for(r.s();!(e=r.n()).done;){var n=e.value;if(3==n.type){var o=c[n.value];if(o.binocular&&t.length>1&&1==t[t.length-1].type&&1==t[t.length-2].type){var i=t.pop().value,a=t.pop().value;t.push({type:1,value:o.processor(a,i)})}else!o.binocular&&t.length>0&&1==t[t.length-1].type?t.push({type:1,value:o.processor(o.pop().value)}):t.push(n)}else t.push(n)}}catch(e){r.e(e)}finally{r.f()}return this.__data=t,this}},{key:"getRPN",value:function(){return this.__data.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){x(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e)}))}},{key:"setRPN",value:function(e){var t=this;if(!Array.isArray(e))throw new TypeError('Input must be an array with objects contains key "type" and "value"');if(!e.length)return this.__data=[],this;var r=[],n=0;if(e.forEach((function(e,o){var i,a;try{i=e.type,a=e.value}catch(e){throw new TypeError("Invalid RPN token at position ".concat(o))}if(2===i){if("string"!=typeof a||!a)throw new TypeError("Invalid RPN token at position ".concat(o));n++}else if(1===i){try{a=t.__numConv(a)}catch(e){throw new TypeError("Invalid number at position ".concat(o))}n++}else{if(3!==i)throw new TypeError("Invalid RPN token at position ".concat(o));var u=c[a];if(!u)throw new TypeError("Invalid operand at position ".concat(o));if(!u.binocular&&n<1||u.binocular&&n<2)throw new SyntaxError("Invalid RPN");u.binocular&&n--}r.push({type:i,value:a})})),1!=n)throw new SyntaxError("Invalid RPN");return this.__data=r,this}},{key:"calc",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.__data.length)return null;var t,r=[],n=S(this.__data);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(1!=o.type)if(2!=o.type){if(3==o.type){var i=c[o.value];if(i.binocular){var a=r.pop(),u=r.pop();r.push(i.processor(u,a))}else r.push(i.processor(r.pop()))}}else{if(!e.hasOwnProperty(o.value))throw new ReferenceError("Value of variable ".concat(o.value," not specified."));r.push(this.__numConv(e[o.value]))}else r.push(o.value)}}catch(e){n.e(e)}finally{n.f()}if(1!=r.length)throw new SyntaxError("Malformed RPN");return r[0]}}])&&E(t.prototype,r),e}());return I(C,"NUM",1),I(C,"VAR",2),I(C,"OPER",3),t.default}()}));